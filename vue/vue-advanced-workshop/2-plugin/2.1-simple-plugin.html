<body>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script>
    // best practice: wrap global mixins in a plugin interface
    const RulesPlugin = {
      install(Vue) {
        Vue.mixin({
          created() {
            if (this.$options.rules) {
              const rules = this.$options.rules;
              Object.keys(rules).forEach(key => {
                const { validate, message } = rules[key];
                // 监听字段的变化，执行校验
                this.$watch(key, newValue => {
                  const result = validate(newValue);
                  if (!result) {
                    console.log(message);
                  }
                });
              });
            }
          }
        });
      }
    };

    // *****************************************
    // test
    Vue.use(RulesPlugin);

    const vm = new Vue({
      data: { foo: 10 },
      rules: {
        foo: {
          validate: value => value > 1,
          message: 'foo must be greater than one'
        }
      }
    });

    vm.foo = 0; // should log: "foo must be greater than one"
  </script>
</body>
