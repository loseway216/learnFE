<template>
  <div class="side">
    <div
      class="item"
      @click="goToMap(data[0], 0)"
      :class="{ onChoose: data[0].flag }"
    >
      <LeftTitleVue>
        <template v-slot>
          <span>安全态势感知</span>
        </template>
      </LeftTitleVue>
      <div class="sub-title">
        <span class="sub-title-square"></span>
        <!-- <span class="sub-title-text">相关数据</span> -->
        <span class="sub-title-line"></span>
      </div>
      <ul>
        <li><span class="count-biz">业务: 10</span></li>
        <li><span class="count-server">服务器: 24</span></li>
        <li><span class="count-app">应用: 13</span></li>
      </ul>
    </div>

    <div class="item" :class="{ onChoose: data[1].flag }">
      <LeftTitleVue>
        <template v-slot>
          <span>工业互联架构</span>
        </template>
      </LeftTitleVue>
      <div class="industryClick" ref="industryClick">
        <span
          v-for="(item, index) in data[1].path"
          @click="switchNetworkTopo(index)"
        >
          {{ item.label }}
        </span>
      </div>
      <ul class="topo-bgc"></ul>
    </div>

    <div class="item" :class="{ onChoose: data[2].flag }">
      <LeftTitleVue>
        <template v-slot>
          <span>设备在线监测</span>
        </template>
      </LeftTitleVue>
      <div class="industryClick" ref="cadTopoClick">
        <span
          v-for="(item, index) in data[2].path"
          @click="switchCadTopo(index)"
        >
          {{ item.label }}
        </span>
      </div>
      <ul class="bitmap"></ul>
    </div>
  </div>
</template>

<script setup>
import { reactive, ref } from "vue";
import { useRoute, useRouter } from "vue-router";
import LeftTitleVue from "../components/LeftTitle/LeftTitle.vue";

const data = reactive([
  {
    title: "全国地图",
    flag: true,
    path: [{ name: "Map" }],
  },
  {
    title: "拓扑图",
    flag: false,
    path: [
      { name: "Topo", params: { id: "1" }, label: "置信电气" },
      { name: "Topo2", params: { id: "2" }, label: "非晶工厂" },
      { name: "Topo3", params: { id: "3" }, label: "天津工厂" },
    ],
  },
  {
    title: "点位图",
    flag: false,
    path: [
      { name: "CadTopo", params: { id: "1" }, label: "非晶A1" },
      { name: "CadTopo2", params: { id: "2" }, label: "非晶A2" },
      { name: "CadTopo3", params: { id: "3" }, label: "非晶B2" },
    ],
  },
]);

const router = useRouter();
const route = useRoute();

const industryClick = ref(null);
const cadTopoClick = ref(null);

function goToMap(item, index) {
  router.push(item.path[index]);
  for (let i of data) {
    i.flag = false;
  }
  for (let item of industryClick.value.children) {
    item.style.backgroundColor = "";
  }
  item.flag = true;
}

function switchNetworkTopo(index) {
  router.push(data[1].path[index]);
  data[1].flag = true;

  data[0].flag = false;
  data[2].flag = false;
  for (let item of industryClick.value.children) {
    item.style.backgroundColor = "";
  }
  industryClick.value.children[index].style.backgroundColor = "#167cff";
}

function switchCadTopo(index) {
  router.push(data[2].path[index]);
  data[2].flag = true;

  data[0].flag = false;
  data[1].flag = false;
  for (let item of cadTopoClick.value.children) {
    item.style.backgroundColor = "";
  }
  cadTopoClick.value.children[index].style.backgroundColor = "#167cff";
}
</script>
<style scoped lang="less">
.side {
  display: flex;
  flex-flow: row wrap;
  align-content: space-around;
  font-size: 16px;
  .item {
    width: 100%;
    height: 33.3%;
    display: flex;
    flex-direction: column;
    padding-top: 10px;
  }
  .sub-title {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB",
      "Microsoft YaHei", SimSun, sans-serif;
    font-size: 18px;
    color: #00ffe4;
    text-align: left;
    line-height: 26px;
    height: 26px;
    padding-left: 25px;
    // margin-bottom: 8px;
    .sub-title-line {
      display: inline-block;
      background: linear-gradient(to right, #fff, #fff, rgba(255, 255, 255, 0));
      width: 70%;
      height: 1px;
      line-height: 6px;
      position: relative;
      left: 2px;
      top: -6px;
    }
    .sub-title-square {
      display: inline-block;
      background: #fff;
      width: 6px;
      height: 6px;
      margin-left: 8px;
      margin-right: 8px;
      position: relative;
      top: -4px;
    }
  }
}

.item ul {
  flex: 1;
  margin-left: 50px;
  height: 80%;
  display: flex;
  flex-direction: column;
  justify-content: space-around;
  color: #00ffe4;
}

.item .bitmap {
  margin-left: 20px;
  margin-right: 20px;
  background: url(../../../assets/images/bitmap.gif) center center / contain
    no-repeat;
}

.item .topo-bgc {
  margin-left: 20px;
  margin-right: 20px;
  background: url(../../../assets/images/topo-demo.png) center center / contain
    no-repeat;
}

.onChoose {
  box-shadow: 0px 0px 20px rgb(51 102 255 / 55%) inset;
  background-color: rgb(51 102 255 / 10%);
}

.industryClick {
  margin-left: 20px;
  margin-right: 10px;
  height: 52px;
  line-height: 52px;
  text-align: center;
  display: flex;
  background: rgba(51, 102, 255, 0.1);
  border: 1px solid rgba(51, 102, 255, 0.5);
  color: #00ffe4;
  cursor: pointer;
  span {
    flex: 1;
    border-right: 1px solid rgba(51, 102, 255, 0.5);
  }
  :last-child {
    border-right: none;
  }
}
</style>
